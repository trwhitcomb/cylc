title = family failure cleanup task example

description = """An example suite in which a special task is
used to automatically clean up a failed task family."""

[scheduling]
    runahead limit = 6
    initial cycle time = 2011010106
    final cycle time = 2011010200
    [[special tasks]]
        sequential = A  # (just to slow the suite down)
    [[dependencies]]
        [[[0,6,12,18]]]
            graph =  """A => fammo
                    fammo | fammo:fail => B
                    fammo | fammo:fail => fammo_cleanup"""
[runtime]
    [[fammo]]

    [[fammo_cleanup]]
        command scripting = fammo_cleanup.sh

    [[m_foo]]
        inherit = fammo
        command scripting = sleep 8 

    [[m_bar]]
        inherit = fammo
        # This task fails at 6,18 and succeeds at 0,12
        command scripting = """
HH=${CYLC_TASK_CYCLE_TIME#????????} 
if (( HH == 6 || HH == 18 )); then
    COMMAND=/bin/false
else
    COMMAND=/bin/true
fi
sleep 5
$COMMAND"""

    [[m_baz]]
        inherit = fammo
        command scripting = sleep 10
